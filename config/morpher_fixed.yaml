# Morpher Training Config (Fixed Steps - No ACT)
#
# Uses Morpher with fixed number of cycles (no adaptive halting)

defaults:
  - _self_

hydra:
  output_subdir: null

# Model architecture
arch:
  name: MorpherFixedSteps
  loss:
    name: ACTLossHead
    loss_type: stablemax_cross_entropy
  
  # Fixed steps (no ACT)
  halt_max_steps: 1
  halt_exploration_prob: 0.0  # Not used
  
  # Morpher architecture
  d: 64
  time_scales: [1, 2, 4]
  enc_dec_rank: 32
  mixer_expansion: 4.0
  dropout: 0.0
  
  # Stacking
  num_levels: 1
  cycles_per_level: [8]      # Total cycles in one shot
  
  # I/O
  io_dim: 512
  puzzle_emb_ndim: 512
  
  # Attention
  stream_head_assignment: shared
  head_input_scope: slot
  attn_backend: sdpa
  pos_encodings: rope

# Data path
data_path: data/arc-aug-1000

# Hyperparams - Training
global_batch_size: 768

epochs: 100000
eval_interval: 10000
checkpoint_every_eval: True

lr: 1e-4
lr_min_ratio: 1.0
lr_warmup_steps: 2000

beta1: 0.9
beta2: 0.95
weight_decay: 0.1
puzzle_emb_weight_decay: 0.1

puzzle_emb_lr: 1e-2
